# perl-versions

GitHub Action that generates Perl version lists for CI matrix builds.

## Architecture

- `perl-versions.js` — Core library: `perl_versions()`, `decode_version()`, `latest_stable_version()`
- `index.js` — Action entry point: reads inputs via `@actions/core`, calls library, sets outputs
- `dist/index.js` — Bundled output (generated by `@vercel/ncc`). **Must be rebuilt** after source changes
- `action.yml` — Action metadata: inputs, outputs, runtime (node24)

## Development

```bash
npm ci              # Install dependencies
npm test            # Run Jest unit tests
npm run lint        # Run ESLint
npm run build       # Rebuild dist/index.js (required before committing source changes)
```

## Code Style

- **Spaces before parentheses** in function calls: `semver.coerce (item)`, `perl_versions ({})`
- **Single quotes** for strings (apostrophes)
- **snake_case** for function and variable names
- **4-space indentation** (see .editorconfig), 2-space for YAML
- **Strict equality** (`===`, enforced by ESLint `eqeqeq` rule)
- **`const` by default** (enforced by ESLint `prefer-const` rule)
- CommonJS modules (`require`/`module.exports`)

## Testing

- Unit tests in `perl-versions.test.js` using Jest
- Integration tests in `.github/workflows/check.yml` (matrix of action invocations)
- Prefer intention-based tests (containment checks like `expect(result).toContain(...)`)
  over exact array matching

## Key Details

- The `available` versions list is internal to `perl-versions.js` (not exported)
- `decode_version()` is the extension point for all input handling
- `dist/index.js` is marked as `linguist-generated` in `.gitattributes`
